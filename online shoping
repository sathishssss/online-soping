import React, { useState } from 'react';
import { ShoppingCart, Search, Star, Plus, Minus, Trash2, Package, CreditCard, Heart, Filter, User, X, Clock, TrendingUp, Tag, MapPin, Phone, Mail } from 'lucide-react';

const EcommerceWebsite = () => {
    const [products] = useState([
        { id: 1, name: 'Wireless Headphones Pro', price: 2999, originalPrice: 4999, category: 'Electronics', rating: 4.5, image: 'ðŸŽ§', stock: 15, description: 'Premium noise-cancelling headphones with 30hrs battery', reviews: 245, discount: 40, tags: ['Bestseller', 'New'] },
        { id: 2, name: 'Smart Watch Ultra', price: 4999, originalPrice: 7999, category: 'Electronics', rating: 4.7, image: 'âŒš', stock: 8, description: 'Fitness tracker with heart rate & GPS', reviews: 189, discount: 38, tags: ['Trending'] },
        { id: 3, name: 'Running Shoes Elite', price: 3499, originalPrice: 5999, category: 'Fashion', rating: 4.3, image: 'ðŸ‘Ÿ', stock: 20, description: 'Comfortable athletic shoes with air cushion', reviews: 432, discount: 42, tags: ['Popular'] },
        { id: 4, name: 'Travel Backpack Pro', price: 1299, originalPrice: 1999, category: 'Fashion', rating: 4.6, image: 'ðŸŽ’', stock: 12, description: 'Durable 30L backpack with laptop compartment', reviews: 156, discount: 35, tags: [] },
        { id: 5, name: 'Coffee Maker Deluxe', price: 5999, originalPrice: 8999, category: 'Home', rating: 4.8, image: 'â˜•', stock: 5, description: 'Automatic drip coffee maker with timer', reviews: 98, discount: 33, tags: ['Limited Stock'] },
        { id: 6, name: 'Yoga Mat Premium', price: 899, originalPrice: 1499, category: 'Sports', rating: 4.4, image: 'ðŸ§˜', stock: 25, description: 'Non-slip 6mm thick exercise mat', reviews: 312, discount: 40, tags: [] },
        { id: 7, name: 'Bluetooth Speaker Max', price: 1999, originalPrice: 2999, category: 'Electronics', rating: 4.5, image: 'ðŸ”Š', stock: 18, description: 'Portable 360Â° sound wireless speaker', reviews: 267, discount: 33, tags: ['Bestseller'] },
        { id: 8, name: 'Polarized Sunglasses', price: 1499, originalPrice: 2499, category: 'Fashion', rating: 4.2, image: 'ðŸ•¶ï¸', stock: 30, description: 'UV400 protection designer sunglasses', reviews: 178, discount: 40, tags: [] },
        { id: 9, name: 'Gaming Mouse RGB', price: 1799, originalPrice: 2999, category: 'Electronics', rating: 4.6, image: 'ðŸ–±ï¸', stock: 22, description: '16000 DPI programmable gaming mouse', reviews: 421, discount: 40, tags: ['Trending'] },
        { id: 10, name: 'Protein Shaker', price: 399, originalPrice: 699, category: 'Sports', rating: 4.3, image: 'ðŸ¥¤', stock: 50, description: 'Leak-proof 700ml shaker with mixer', reviews: 89, discount: 43, tags: [] },
    ]);

    const [cart, setCart] = useState([]);
    const [wishlist, setWishlist] = useState([]);
    const [searchTerm, setSearchTerm] = useState('');
    const [selectedCategory, setSelectedCategory] = useState('All');
    const [showCart, setShowCart] = useState(false);
    const [showCheckout, setShowCheckout] = useState(false);
    const [showDetail, setShowDetail] = useState(null);
    const [sortBy, setSortBy] = useState('featured');
    const [maxPrice, setMaxPrice] = useState(10000);
    const [orderHistory, setOrderHistory] = useState([]);
    const [showOrders, setShowOrders] = useState(false);
    const [userData, setUserData] = useState({ name: '', email: '', phone: '', address: '' });

    const categories = ['All', 'Electronics', 'Fashion', 'Home', 'Sports'];

    const filtered = products.filter(p => {
        const matchSearch = p.name.toLowerCase().includes(searchTerm.toLowerCase());
        const matchCat = selectedCategory === 'All' || p.category === selectedCategory;
        const matchPrice = p.price <= maxPrice;
        return matchSearch && matchCat && matchPrice;
    });

    const sorted = [...filtered].sort((a, b) => {
        if (sortBy === 'price-low') return a.price - b.price;
        if (sortBy === 'price-high') return b.price - a.price;
        if (sortBy === 'rating') return b.rating - a.rating;
        if (sortBy === 'popular') return b.reviews - a.reviews;
        return 0;
    });

    const addCart = (p) => {
        const exist = cart.find(i => i.id === p.id);
        if (exist) {
            setCart(cart.map(i => i.id === p.id ? { ...i, qty: Math.min(i.qty + 1, p.stock) } : i));
        } else {
            setCart([...cart, { ...p, qty: 1 }]);
        }
    };

    const updateQty = (id, change) => {
        setCart(cart.map(i => {
            if (i.id === id) {
                const newQty = i.qty + change;
                return newQty > 0 && newQty <= i.stock ? { ...i, qty: newQty } : i;
            }
            return i;
        }).filter(i => i.qty > 0));
    };

    const toggleWish = (p) => {
        wishlist.find(i => i.id === p.id)
            ? setWishlist(wishlist.filter(i => i.id !== p.id))
            : setWishlist([...wishlist, p]);
    };

    const total = cart.reduce((s, i) => s + i.price * i.qty, 0);
    const totalItems = cart.reduce((s, i) => s + i.qty, 0);
    const savings = cart.reduce((s, i) => s + (i.originalPrice - i.price) * i.qty, 0);

    const placeOrder = () => {
        const order = {
            id: Date.now(),
            items: [...cart],
            total: total + 50,
            date: new Date().toLocaleDateString(),
            status: 'Processing'
        };
        setOrderHistory([order, ...orderHistory]);
        setCart([]);
        setShowCheckout(false);
        setShowCart(false);
        alert('ðŸŽ‰ Order placed! ID: ' + order.id);
    };

    return (
        <div className= "min-h-screen bg-gray-50" >
        {/* Header */ }
        < header className = "bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg sticky top-0 z-50" >
            <div className="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between" >
                <div className="flex items-center gap-2 cursor-pointer" onClick = {() => { setShowCart(false); setShowCheckout(false); setShowOrders(false); setShowDetail(null); }}>
                    <Package className="w-8 h-8" />
                        <h1 className="text-2xl font-bold" > ShopHub </h1>
                            </div>

                            < div className = "flex-1 max-w-2xl mx-8" >
                                <div className="relative" >
                                    <Search className="absolute left-3 top-3 w-5 h-5 text-gray-400" />
                                        <input
                type="text"
placeholder = "Search products..."
value = { searchTerm }
onChange = {(e) => setSearchTerm(e.target.value)}
className = "w-full pl-10 pr-4 py-2 rounded-lg text-gray-800 focus:ring-2 focus:ring-white"
    />
    </div>
    </div>

    < div className = "flex gap-3" >
        <button onClick={ () => { setShowOrders(true); setShowCart(false); setShowCheckout(false); } } className = "p-2 hover:bg-white/20 rounded-lg relative" >
            <Clock className="w-6 h-6" />
                { orderHistory.length > 0 && <span className="absolute -top-1 -right-1 bg-green-500 text-xs rounded-full w-5 h-5 flex items-center justify-center"> { orderHistory.length } </span> }
                </button>
                < button onClick = {() => { setShowCart(!showCart); setShowCheckout(false); setShowOrders(false); }} className = "p-2 hover:bg-white/20 rounded-lg relative" >
                    <ShoppingCart className="w-6 h-6" />
                        { totalItems > 0 && <span className="absolute -top-1 -right-1 bg-red-500 text-xs rounded-full w-5 h-5 flex items-center justify-center" > { totalItems } </span>}
</button>
    < button className = "p-2 hover:bg-white/20 rounded-lg relative" >
        <Heart className="w-6 h-6" />
            { wishlist.length > 0 && <span className="absolute -top-1 -right-1 bg-pink-500 text-xs rounded-full w-5 h-5 flex items-center justify-center"> { wishlist.length } </span> }
            </button>
            </div>
            </div>
            </header>

            < div className = "max-w-7xl mx-auto px-4 py-6" >
                <div className="flex gap-6" >
                    {/* Sidebar */ }
{
    !showCart && !showCheckout && !showOrders && !showDetail && (
        <aside className="w-64 space-y-4" >
            <div className="bg-white rounded-lg shadow-md p-4" >
                <h3 className="font-semibold mb-3 flex items-center gap-2" >
                    <Filter className="w-5 h-5" />
                        Categories
                        </h3>
                        < div className = "space-y-2" >
                        {
                            categories.map(c => (
                                <button key= { c } onClick = {() => setSelectedCategory(c)}
    className = {`w-full text-left px-3 py-2 rounded-lg ${selectedCategory === c ? 'bg-blue-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`
}>
    { c }
    </button>
                  ))}
</div>
    </div>

    < div className = "bg-white rounded-lg shadow-md p-4" >
        <h3 className="font-semibold mb-3" > Max Price: â‚¹{ maxPrice } </h3>
            < input type = "range" min = "0" max = "10000" step = "100" value = { maxPrice } onChange = {(e) => setMaxPrice(parseInt(e.target.value))} className = "w-full" />
                </div>

                < div className = "bg-white rounded-lg shadow-md p-4" >
                    <h3 className="font-semibold mb-3" > Sort By </h3>
                        < select value = { sortBy } onChange = {(e) => setSortBy(e.target.value)} className = "w-full px-3 py-2 border rounded-lg" >
                            <option value="featured" > Featured </option>
                                < option value = "price-low" > Price: Low - High </option>
                                    < option value = "price-high" > Price: High - Low </option>
                                        < option value = "rating" > Top Rated </option>
                                            < option value = "popular" > Most Popular </option>
                                                </select>
                                                </div>
                                                </aside>
          )}

{/* Main */ }
<main className="flex-1" >
    {/* Orders */ }
{
    showOrders && (
        <div className="bg-white rounded-lg shadow-md p-6" >
            <h2 className="text-2xl font-bold mb-6" > Order History </h2>
    {
        orderHistory.length === 0 ? (
            <div className= "text-center py-12 text-gray-400" >
            <Clock className="w-16 h-16 mx-auto mb-3 opacity-50" />
                <p>No orders yet </p>
                    </div>
                ) : (
            <div className= "space-y-4" >
            {
                orderHistory.map(o => (
                    <div key= { o.id } className = "border rounded-lg p-4" >
                    <div className="flex justify-between mb-3" >
                <div>
                <p className="font-semibold" > Order #{ o.id } </p>
                < p className = "text-sm text-gray-600" > { o.date } </p>
                </div>
                < span className = "px-3 py-1 bg-yellow-100 text-yellow-700 text-sm rounded-full" > { o.status } </span>
                </div>
                        {
                        o.items.map(i => (
                            <div key= { i.id } className = "flex gap-3 text-sm mb-2" >
                            <span className="text-2xl" > { i.image } </span>
                        < span className = "flex-1" > { i.name } x{ i.qty } </span>
                        < span className = "font-semibold" >â‚¹{ i.price * i.qty } </span>
                        </div>
                        ))
            }
            < div className = "flex justify-between border-t pt-3 mt-3" >
                <span className="font-semibold" > Total: </span>
                    < span className = "text-xl font-bold text-blue-600" >â‚¹{ o.total } </span>
                        </div>
                        </div>
                    ))
    }
    </div>
                )
}
</div>
            )}

{/* Product Detail Modal */ }
{
    showDetail && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" >
            <div className="bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto p-6" >
                <div className="flex justify-between items-start mb-4" >
                    <h2 className="text-2xl font-bold" > { showDetail.name } </h2>
                        < button onClick = {() => setShowDetail(null)
} className = "p-2 hover:bg-gray-100 rounded-lg" >
    <X className="w-6 h-6" />
        </button>
        </div>
        < div className = "text-8xl text-center my-6" > { showDetail.image } </div>
            < div className = "space-y-4" >
                <div className="flex items-center gap-4" >
                    <div>
                    <span className="text-3xl font-bold text-blue-600" >â‚¹{ showDetail.price } </span>
                        < span className = "text-xl text-gray-400 line-through ml-2" >â‚¹{ showDetail.originalPrice } </span>
                            </div>
                            < span className = "bg-red-500 text-white px-3 py-1 rounded-full font-semibold" > { showDetail.discount } % OFF </span>
                                </div>
                                < div className = "flex items-center gap-2" >
                                    <Star className="w-5 h-5 text-yellow-400" fill = "currentColor" />
                                        <span className="font-semibold" > { showDetail.rating } </span>
                                            < span className = "text-gray-500" > ({ showDetail.reviews } reviews)</span>
                                                </div>
                                                < p className = "text-gray-700" > { showDetail.description } </p>
                                                    < div className = "flex gap-2" >
                                                    {
                                                        showDetail.tags.map(t => (
                                                            <span key= { t } className = "px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm" > { t } </span>
                                                        ))
                                                    }
                                                        </div>
                                                        < p className = "text-sm" > <span className="font-semibold" > Stock: </span> {showDetail.stock} available</p >
                                                            <button onClick={ () => { addCart(showDetail); setShowDetail(null); } } className = "w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold" >
                                                                Add to Cart
                                                                    </button>
                                                                    </div>
                                                                    </div>
                                                                    </div>
            )}

{/* Products */ }
{
    !showCart && !showCheckout && !showOrders && !showDetail && (
        <>
        <div className="flex justify-between mb-4" >
            <h2 className="text-2xl font-bold" > { selectedCategory } < span className = "text-gray-500 text-lg" > ({ sorted.length }) < /span></h2 >
                </div>
                < div className = "grid md:grid-cols-2 lg:grid-cols-3 gap-6" >
                {
                    sorted.map(p => (
                        <div key= { p.id } className = "bg-white rounded-lg shadow-md hover:shadow-xl transition p-4" >
                        <div className="relative" >
                    <div className="text-6xl text-center mb-3 cursor-pointer" onClick = {() => setShowDetail(p)} > { p.image } </div>
    { p.discount > 0 && <span className="absolute top-0 right-0 bg-red-500 text-white text-xs px-2 py-1 rounded" > { p.discount } % OFF </span> }
    <button onClick={ () => toggleWish(p) } className = {`absolute top-0 left-0 p-1 ${wishlist.find(i => i.id === p.id) ? 'text-pink-500' : 'text-gray-400'}`
}>
    <Heart className="w-5 h-5" fill = { wishlist.find(i => i.id === p.id) ? 'currentColor' : 'none' } />
        </button>
        </div>
        < h3 className = "font-bold mb-1 cursor-pointer hover:text-blue-600" onClick = {() => setShowDetail(p)}> { p.name } </h3>
            < p className = "text-sm text-gray-600 mb-2 line-clamp-2" > { p.description } </p>
                < div className = "flex items-center gap-1 mb-3" >
                    <Star className="w-4 h-4 text-yellow-400" fill = "currentColor" />
                        <span className="text-sm font-semibold" > { p.rating } </span>
                            < span className = "text-xs text-gray-400" > ({ p.reviews }) </span>
                                </div>
                                < div className = "flex justify-between items-end" >
                                    <div>
                                    <div className="flex items-center gap-2" >
                                        <span className="text-2xl font-bold text-blue-600" >â‚¹{ p.price } </span>
                                            < span className = "text-sm text-gray-400 line-through" >â‚¹{ p.originalPrice } </span>
                                                </div>
                                                < span className = "text-xs text-green-600" > Save â‚¹{ p.originalPrice - p.price } </span>
                                                    </div>
                                                    < button onClick = {() => addCart(p)} className = "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-1" >
                                                        <Plus className="w-4 h-4" /> Add
                                                            </button>
                                                            </div>
                                                            </div>
                  ))}
</div>
    </>
            )}

{/* Cart */ }
{
    showCart && !showCheckout && (
        <div className="bg-white rounded-lg shadow-md p-6" >
            <h2 className="text-2xl font-bold mb-6" > Cart({ totalItems }) </h2>
    {
        cart.length === 0 ? (
            <div className= "text-center py-12 text-gray-400" >
            <ShoppingCart className="w-16 h-16 mx-auto mb-3 opacity-50" />
                <p>Cart is empty </p>
                    </div>
                ) : (
            <>
            <div className= "space-y-4 mb-6" >
            {
                cart.map(i => (
                    <div key= { i.id } className = "flex items-center gap-4 p-4 border rounded-lg" >
                    <span className="text-4xl" > { i.image } </span>
                < div className = "flex-1" >
                <h3 className="font-semibold" > { i.name } </h3>
                < p className = "text-blue-600 font-bold" >â‚¹{ i.price } </p>
                </div>
                < div className = "flex items-center gap-2" >
                <button onClick={() => updateQty(i.id, -1)} className = "p-2 hover:bg-gray-100 rounded" >
                    <Minus className="w-4 h-4" />
                        </button>
                        < span className = "w-8 text-center font-semibold" > { i.qty } </span>
                            < button onClick = {() => updateQty(i.id, 1)
    } disabled = { i.qty >= i.stock } className = "p-2 hover:bg-gray-100 rounded disabled:opacity-50" >
        <Plus className="w-4 h-4" />
            </button>
            </div>
            < span className = "font-bold text-blue-600 w-20 text-right" >â‚¹{ i.price * i.qty } </span>
                < button onClick = {() => setCart(cart.filter(c => c.id !== i.id))
} className = "p-2 text-red-500 hover:bg-red-50 rounded" >
    <Trash2 className="w-5 h-5" />
        </button>
        </div>
                      ))}
</div>
    < div className = "border-t pt-4 space-y-2" >
        <div className="flex justify-between" >
            <span>Subtotal: </span>
                <span>â‚¹{ total } </span>
                    </div>
                    < div className = "flex justify-between text-green-600 font-semibold" >
                        <span>Savings: </span>
                            < span > -â‚¹{ savings } </span>
                                </div>
                                < div className = "flex justify-between" >
                                    <span>Delivery: </span>
                                        <span>â‚¹50 </span>
                                            </div>
                                            < div className = "flex justify-between text-xl font-bold border-t pt-2" >
                                                <span>Total: </span>
                                                    < span className = "text-blue-600" >â‚¹{ total + 50 } </span>
                                                        </div>
                                                        < button onClick = {() => setShowCheckout(true)} className = "w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold flex items-center justify-center gap-2" >
                                                            <CreditCard className="w-5 h-5" />
                                                                Checkout
                                                                </button>
                                                                </div>
                                                                </>
                )}
</div>
            )}

{/* Checkout */ }
{
    showCheckout && (
        <div className="bg-white rounded-lg shadow-md p-6" >
            <h2 className="text-2xl font-bold mb-6" > Checkout </h2>
                < div className = "grid md:grid-cols-2 gap-6" >
                    <div className="space-y-4" >
                        <div>
                        <label className="block font-semibold mb-2" > <User className="w-4 h-4 inline mr-1" /> Name </label>
                            < input value = { userData.name } onChange = {(e) => setUserData({ ...userData, name: e.target.value })
} className = "w-full px-4 py-2 border rounded-lg" />
    </div>
    < div >
    <label className="block font-semibold mb-2" > <Mail className="w-4 h-4 inline mr-1" /> Email </label>
        < input type = "email" value = { userData.email } onChange = {(e) => setUserData({ ...userData, email: e.target.value })} className = "w-full px-4 py-2 border rounded-lg" />
            </div>
            < div >
            <label className="block font-semibold mb-2" > <Phone className="w-4 h-4 inline mr-1" /> Phone </label>
                < input type = "tel" value = { userData.phone } onChange = {(e) => setUserData({ ...userData, phone: e.target.value })} className = "w-full px-4 py-2 border rounded-lg" />
                    </div>
                    < div >
                    <label className="block font-semibold mb-2" > <MapPin className="w-4 h-4 inline mr-1" /> Address </label>
                        < textarea rows = "3" value = { userData.address } onChange = {(e) => setUserData({ ...userData, address: e.target.value })} className = "w-full px-4 py-2 border rounded-lg" />
                            </div>
                            </div>
                            < div >
                            <div className="bg-gray-50 rounded-lg p-4 space-y-2" >
                                <h3 className="font-bold mb-3" > Order Summary </h3>
{
    cart.map(i => (
        <div key= { i.id } className = "flex justify-between text-sm" >
        <span>{ i.name } x{ i.qty } </span>
        <span>â‚¹{ i.price * i.qty } </span>
    </div>
    ))
}
<div className="border-t pt-2 mt-2 space-y-1" >
    <div className="flex justify-between" > <span>Subtotal: </span><span>â‚¹{total}</span > </div>
        < div className = "flex justify-between text-green-600" > <span>Savings: </span><span>-â‚¹{savings}</span > </div>
            < div className = "flex justify-between" > <span>Delivery: </span><span>â‚¹50</span > </div>
                < div className = "flex justify-between font-bold text-lg border-t pt-2" > <span>Total: </span><span className="text-blue-600">â‚¹{total + 50}</span > </div>
                    </div>
                    </div>
                    < button onClick = { placeOrder } className = "w-full mt-4 bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold" >
                        Place Order
                            </button>
                            </div>
                            </div>
                            </div>
            )}
</main>
    </div>
    </div>
    </div>
  );
};

export default EcommerceWebsite;